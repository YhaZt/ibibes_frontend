name: Deploy Backend & Frontend to Hostinger

on:
  push:
    branches:
      - main  # Change to your main branch if needed

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ Checkout Repository
        uses: actions/checkout@v2

      # ğŸ“Œ Debug GitHub Secrets (Ensure secrets are properly set)
      - name: ğŸ” Debug Secrets
        run: |
          [[ -n "${{ secrets.FTP_SERVER }}" ]] && echo "âœ… FTP_SERVER is set!" || echo "âŒ FTP_SERVER is missing!"
          [[ -n "${{ secrets.FTP_USERNAME }}" ]] && echo "âœ… FTP_USERNAME is set!" || echo "âŒ FTP_USERNAME is missing!"
          [[ -n "${{ secrets.FTP_PASSWORD }}" ]] && echo "âœ… FTP_PASSWORD is set!" || echo "âŒ FTP_PASSWORD is missing!"
          [[ -n "${{ secrets.SSH_PRIVATE_KEY }}" ]] && echo "âœ… SSH_PRIVATE_KEY is set!" || echo "âŒ SSH_PRIVATE_KEY is missing!"
          [[ -n "${{ secrets.SSH_DOMAIN }}" ]] && echo "âœ… SSH_DOMAIN is set!" || echo "âŒ SSH_DOMAIN is missing!"
        shell: bash

      # ğŸ“Œ Install Node.js, Dependencies, and Build Vue App
      - name: Install Dependencies & Build Quasar App
        run: |
          npm install
          quasar clean
          quasar build
        shell: bash

      # ğŸ“Œ Upload Vue.js (dist/) to Hostinger via FTP
      - name: ğŸš€ Upload Vue.js (dist/) to Hostinger
        uses: SamKirkland/FTP-Deploy-Action@v4.3.1
        with:
          server: ${{ secrets.FTP_SERVER }}
          username: ${{ secrets.FTP_USERNAME }}
          password: ${{ secrets.FTP_PASSWORD }}
          local-dir: dist/spa/
          server-dir: /1test/
